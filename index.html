<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Alcys-orm by AlcyZ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Alcys-orm</h1>
      <h2 class="project-tagline">Ein PHP-ORM System, Test Driven Entwickelt, 100% Code-Coverage und inklusive API Dokumentation.</h2>
      <a href="https://github.com/AlcyZ/Alcys-ORM" class="btn">View on GitHub</a>
      <a href="https://github.com/AlcyZ/Alcys-ORM/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/AlcyZ/Alcys-ORM/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="alcys-orm" class="anchor" href="#alcys-orm" aria-hidden="true"><span class="octicon octicon-link"></span></a>Alcys-ORM</h1>

<p>A test driven developed PHP-ORM system, 100Â½ code coverage with API documentation.
Actually, i only support MySql, but other driver will follow.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Download and extract the zip package. Copy the src/ directory to your project and use
a PSR-0 or PSR-4 autoloader to require the files. In the package root directory exist a
small and simple PSR-0 autoloader, which also could used.</p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">require_once</span> <span class="pl-s"><span class="pl-pds">'</span>Autoloader.php<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c1">spl_autoload_register</span>(</span>
<span class="pl-s1">    <span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>Autoloader<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>load<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c1">Autoloader</span><span class="pl-k">::</span>register(<span class="pl-s"><span class="pl-pds">'</span>src/<span class="pl-pds">'</span></span>);</span></pre></div>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Instantiate an object of the class Alcys\Core\Db\Service\AlcysDb. There are some methods
to create whether SELECT, INSERT, DELETE or UPDATE statement objects which communicate with the database.</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-smi">$db</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Alcys\Core\Db\Service\</span><span class="pl-c1">AlcysDb</span>(<span class="pl-s"><span class="pl-pds">'</span>mysql:host=localhost;dbname=db_name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>db_user<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>db_password<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$select</span> <span class="pl-k">=</span> <span class="pl-smi">$db</span><span class="pl-k">-&gt;</span>select(<span class="pl-s"><span class="pl-pds">'</span>table_name<span class="pl-pds">'</span></span>); <span class="pl-c"># Object for select statements</span></span>
<span class="pl-s1"><span class="pl-smi">$update</span> <span class="pl-k">=</span> <span class="pl-smi">$db</span><span class="pl-k">-&gt;</span>update(<span class="pl-s"><span class="pl-pds">'</span>table_name<span class="pl-pds">'</span></span>); <span class="pl-c"># Object for update statements</span></span>
<span class="pl-s1"><span class="pl-smi">$insert</span> <span class="pl-k">=</span> <span class="pl-smi">$db</span><span class="pl-k">-&gt;</span>insert(<span class="pl-s"><span class="pl-pds">'</span>table_name<span class="pl-pds">'</span></span>); <span class="pl-c"># Object for insert statements</span></span>
<span class="pl-s1"><span class="pl-smi">$delete</span> <span class="pl-k">=</span> <span class="pl-smi">$db</span><span class="pl-k">-&gt;</span>delete(<span class="pl-s"><span class="pl-pds">'</span>table_name<span class="pl-pds">'</span></span>); <span class="pl-c"># Object for delete statements</span></span></pre></div>

<p>The table name is required to pass it as argument through the create method. To add other tables, 
simple use the table() method which exists in each statement object.
If the columns method, which only not exist in the delete statement, will not called, a wildcard (*) will 
add for the columns.</p>

<h2>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h2>

<p>Simple select query:</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># SELECT `test_column`, `column` AS `clm` FROM `test_table` AS `my_table` ORDER BY `clm` DESC;</span></span>
<span class="pl-s1"><span class="pl-smi">$select</span> <span class="pl-k">=</span> <span class="pl-smi">$db</span><span class="pl-k">-&gt;</span>select(<span class="pl-s"><span class="pl-pds">`</span>test_table<span class="pl-pds">`</span></span>, <span class="pl-s"><span class="pl-pds">`</span>my_table<span class="pl-pds">`</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$resultArray</span> <span class="pl-k">=</span> <span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>column(<span class="pl-s"><span class="pl-pds">'</span>test_column<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">                      <span class="pl-k">-&gt;</span>column(<span class="pl-s"><span class="pl-pds">'</span>column<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>clm<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">                      <span class="pl-k">-&gt;</span>orderBy(<span class="pl-s"><span class="pl-pds">'</span>clm<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>desc<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">                      <span class="pl-k">-&gt;</span>fetch();</span></pre></div>

<p>Simple update query:</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># UPDATE `test_table` SET `column` = "value", `clm` = "val" LIMIT 4, 15;</span></span>
<span class="pl-s1"><span class="pl-smi">$update</span> <span class="pl-k">=</span> <span class="pl-smi">$db</span><span class="pl-k">-&gt;</span>update(<span class="pl-s"><span class="pl-pds">`</span>test_table<span class="pl-pds">`</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$update</span><span class="pl-k">-&gt;</span>column(<span class="pl-s"><span class="pl-pds">'</span>column<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>value(<span class="pl-s"><span class="pl-pds">'</span>value<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">       <span class="pl-k">-&gt;</span>column(<span class="pl-s"><span class="pl-pds">'</span>clm<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>value(<span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">       <span class="pl-k">-&gt;</span>limit(<span class="pl-s"><span class="pl-pds">'</span>4<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>15<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">       <span class="pl-k">-&gt;</span>execute();</span></pre></div>

<p>Simple insert query:</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># INSERT INTO `test_table` (`column`, `clm`) VALUES ("val", "value"), ("any_value", "this_value");</span></span>
<span class="pl-s1"><span class="pl-smi">$insert</span> <span class="pl-k">=</span> <span class="pl-smi">$db</span><span class="pl-k">-&gt;</span>insert(<span class="pl-s"><span class="pl-pds">`</span>test_table<span class="pl-pds">`</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$insert</span><span class="pl-k">-&gt;</span>columns(<span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>column<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>clm<span class="pl-pds">'</span></span>))</span>
<span class="pl-s1">       <span class="pl-k">-&gt;</span>values(<span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>value<span class="pl-pds">'</span></span>))</span>
<span class="pl-s1">       <span class="pl-k">-&gt;</span>values(<span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>any_value<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>this_value<span class="pl-pds">'</span></span>))</span>
<span class="pl-s1">       <span class="pl-k">-&gt;</span>execute();</span></pre></div>

<p>Simple delete query:</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># DELETE FROM `test_table` ORDER BY `column` ASC LIMIT 0, 5;</span></span>
<span class="pl-s1"><span class="pl-smi">$delete</span> <span class="pl-k">=</span> <span class="pl-smi">$db</span><span class="pl-k">-&gt;</span>delete(<span class="pl-s"><span class="pl-pds">`</span>test_table<span class="pl-pds">`</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$delete</span><span class="pl-k">-&gt;</span>orderBy(<span class="pl-s"><span class="pl-pds">'</span>column<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">       <span class="pl-k">-&gt;</span>limit(<span class="pl-s"><span class="pl-pds">'</span>0<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>5<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">       <span class="pl-k">-&gt;</span>execute();</span></pre></div>

<h2>
<a id="where-conditions" class="anchor" href="#where-conditions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Where-Conditions</h2>

<p>All statement objects, instead of the InsertStatement, have a 'condition' method which return an object
for the creation of conditions. After call some methods of the object to build the condition, pass it to
the 'where' method.</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># WHERE `column_name` != 'value'</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$delete</span><span class="pl-k">-&gt;</span>where(<span class="pl-smi">$delete</span><span class="pl-k">-&gt;</span>condition()<span class="pl-k">-&gt;</span>notEqual(<span class="pl-s"><span class="pl-pds">'</span>column_name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>value<span class="pl-pds">'</span></span>));</span></pre></div>

<p>If you want to compare two columns, pass as third argument the string 'column'.</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># WHERE `first_column` &gt;= `second_column`</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$update</span><span class="pl-k">-&gt;</span>where(<span class="pl-smi">$update</span><span class="pl-k">-&gt;</span>condition()<span class="pl-k">-&gt;</span>greaterEqual(<span class="pl-s"><span class="pl-pds">'</span>first_column, <span class="pl-pds">'</span></span><span class="pl-c1">second_column</span><span class="pl-s"><span class="pl-pds">'</span>, <span class="pl-pds">'</span></span><span class="pl-c1">column</span><span class="pl-s"><span class="pl-pds">'</span>);</span></span></pre></div>

<p>To connect multiple conditions, you have to invoke the methods 'logicAnd' and 'logicOr' between
the other condition methods.
If they not called between conditions, an exception will thrown.</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># WHERE `first_column` = 'a' AND `cl` != `clm` OR `column` &lt; 5</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$condition</span> <span class="pl-k">=</span> <span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>condition();</span>
<span class="pl-s1"><span class="pl-smi">$condition</span><span class="pl-k">-&gt;</span>equal(<span class="pl-s"><span class="pl-pds">'</span>first_column<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>logicAnd()<span class="pl-k">-&gt;</span>notEqual(<span class="pl-s"><span class="pl-pds">'</span>cl<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>clm<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>column<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>logicOr()<span class="pl-k">-&gt;</span>lower(<span class="pl-s"><span class="pl-pds">'</span>column<span class="pl-pds">'</span></span>, <span class="pl-c1">5</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>where(<span class="pl-smi">$condition</span>)<span class="pl-k">-&gt;</span>fetch();</span></pre></div>

<p>Like conditions will follow ..</p>

<h2>
<a id="joins" class="anchor" href="#joins" aria-hidden="true"><span class="octicon octicon-link"></span></a>Joins</h2>

<p>At the current version, joins are only implemented in the select statement. The functionality is implemented for other
statements in the next version.</p>

<p>The method 'joinBuilder' returns an object for the creation of the join expression. This have to pass to the statements 
'join' method.</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># LEFT JOIN `table_name` USING `column`</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>join(<span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>joinBuilder()<span class="pl-k">-&gt;</span>left(<span class="pl-s"><span class="pl-pds">'</span>table_name<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>using(<span class="pl-s"><span class="pl-pds">'</span>column<span class="pl-pds">'</span></span>));</span></pre></div>

<p>The arguments for the 'on' method has to be two assoc arrays with keys 'table' and 'column'.
If the arrays are invalid, an exception will thrown.</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># INNER JOIN `table` ON (`tbl`.`cl`, `table`.`clm`);</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$firstColumn</span> <span class="pl-k">=</span> <span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>tbl<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>column<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>cl<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$secondColumn</span> <span class="pl-k">=</span> <span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>table<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>column<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>clm<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>join(<span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>joinBuilder()<span class="pl-k">-&gt;</span>inner(<span class="pl-s"><span class="pl-pds">'</span>table<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>on(<span class="pl-smi">$firstColumn</span>, <span class="pl-smi">$secondColumn</span>));</span>
<span class="pl-s1"></span></pre></div>

<p>Before calling the 'on' or 'using' method, you have to invoke whether the 'inner', 'left[Outer]' or 'right[Outer]' method,
otherwise an exception will thrown.</p>

<p>If you want to join a table with all equivalent column names, you can use the 'natural' method.
The first argument is the table name, the optional second can be whether 'inner', 'left[Outer]' or 'right[Outer].</p>

<div class="highlight highlight-php"><pre><span class="pl-s1"><span class="pl-c"># NATURAL JOIN `table`</span></span>
<span class="pl-s1"><span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>join(<span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>joinBuilder()<span class="pl-k">-&gt;</span>natural(<span class="pl-s"><span class="pl-pds">'</span>table<span class="pl-pds">'</span></span>));</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"># NATURAL RIGHT JOIN `table`</span></span>
<span class="pl-s1"><span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>join(<span class="pl-smi">$select</span><span class="pl-k">-&gt;</span>joinBuilder()<span class="pl-k">-&gt;</span>natural(<span class="pl-s"><span class="pl-pds">'</span>table<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>right<span class="pl-pds">'</span></span>));</span></pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/AlcyZ/Alcys-ORM">Alcys-orm</a> is maintained by <a href="https://github.com/AlcyZ">AlcyZ</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

